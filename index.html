<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Construcciones Magdaleno</title>
    <style>
        *{margin:0;padding:0;box-sizing:border-box}body{font-family:'Segoe UI',sans-serif;color:#333;line-height:1.6}.header{background:linear-gradient(135deg,#0f172a 0%,#1e3a8a 100%);color:white;padding:1rem 0;position:sticky;top:0;z-index:100;box-shadow:0 2px 10px rgba(0,0,0,0.1)}.nav-container{max-width:1200px;margin:0 auto;padding:0 2rem;display:flex;justify-content:space-between;align-items:center;flex-wrap:wrap}.logo{display:flex;align-items:center;gap:0.5rem;font-size:1.5rem;font-weight:bold}.logo-icon{font-size:3rem;display:flex;align-items:center}.logo-icon img{width:3rem;height:3rem;object-fit:contain}.nav-menu{display:flex;gap:2rem;list-style:none;align-items:center;flex-wrap:wrap}.nav-menu a{color:white;text-decoration:none;cursor:pointer}.nav-menu a:hover{color:#d4a574}.admin-btn{background:#d4a574;color:#0f172a;padding:0.5rem 1rem;border-radius:5px;border:none;cursor:pointer;font-weight:bold}.hero{background:linear-gradient(135deg,#1e3a8a 0%,#0f172a 100%);color:white;padding:4rem 2rem;text-align:center}.hero h1{font-size:3rem;margin-bottom:1rem}.hero p{font-size:1.2rem}.container{max-width:1200px;margin:0 auto;padding:4rem 2rem}.section-title{font-size:2.5rem;color:#0f172a;margin-bottom:2rem;text-align:center}.section-title::after{content:'';display:block;width:60px;height:4px;background:#d4a574;margin:1rem auto}.about-content{background:white;padding:2rem;border-radius:10px;box-shadow:0 4px 20px rgba(0,0,0,0.1);font-size:1.1rem}.filters{display:flex;flex-wrap:wrap;gap:1rem;margin-bottom:2rem;justify-content:center}.filter-btn{background:white;color:#0f172a;padding:0.7rem 1.5rem;border:2px solid #d4a574;border-radius:25px;cursor:pointer;font-weight:500}.filter-btn:hover,.filter-btn.active{background:#d4a574;color:white}.trabajos-grid{display:grid;gap:2rem}.trabajo-card{background:white;border-radius:10px;overflow:hidden;box-shadow:0 4px 20px rgba(0,0,0,0.1);transition:all 0.3s}.trabajo-card:hover{transform:translateY(-5px)}.trabajo-card.admin-mode{cursor:pointer}.trabajo-img{width:100%;height:300px;object-fit:cover}.trabajo-content{padding:1.5rem}.trabajo-header{display:flex;justify-content:space-between;align-items:start;margin-bottom:1rem}.trabajo-title{font-size:1.5rem;color:#0f172a}.trabajo-category{background:#d4a574;color:white;padding:0.3rem 0.8rem;border-radius:15px;font-size:0.85rem}.trabajo-date{color:#666;font-size:0.9rem;margin-bottom:1rem}.trabajo-description{color:#555}.contact-info{background:white;padding:2rem;border-radius:10px;box-shadow:0 4px 20px rgba(0,0,0,0.1);text-align:center}.contact-info h3{color:#0f172a;margin-bottom:1rem;font-size:1.5rem}.contact-info p{font-size:1.1rem;color:#555;margin:0.5rem 0}.contact-phone{color:#d4a574;font-weight:bold;font-size:1.3rem}.whatsapp-float{position:fixed;bottom:30px;right:30px;background:#25D366;color:white;width:60px;height:60px;border-radius:50%;display:flex;align-items:center;justify-content:center;font-size:2rem;box-shadow:0 4px 20px rgba(0,0,0,0.3);z-index:99;text-decoration:none}.modal{display:none;position:fixed;top:0;left:0;width:100%;height:100%;background:rgba(0,0,0,0.7);z-index:1000;align-items:center;justify-content:center}.modal.active{display:flex}.modal-content{background:white;padding:2rem;border-radius:10px;max-width:500px;width:90%;max-height:90vh;overflow-y:auto}.modal-header{display:flex;justify-content:space-between;align-items:center;margin-bottom:1.5rem}.modal-title{font-size:1.5rem;color:#0f172a}.close-btn{background:none;border:none;font-size:1.5rem;cursor:pointer;color:#666}.form-group{margin-bottom:1.5rem}.form-group label{display:block;margin-bottom:0.5rem;color:#0f172a;font-weight:500}.form-group input,.form-group textarea,.form-group select{width:100%;padding:0.8rem;border:2px solid #ddd;border-radius:5px;font-size:1rem}.form-group textarea{resize:vertical;min-height:100px}.btn{background:#d4a574;color:white;padding:0.8rem 2rem;border:none;border-radius:5px;cursor:pointer;font-size:1rem;font-weight:bold}.btn:hover{background:#1e3a8a}.btn-secondary{background:#666;margin-left:0.5rem}.btn-danger{background:#dc2626}.admin-panel{display:grid;gap:1rem}.admin-section{background:#f5e6d3;padding:1.5rem;border-radius:8px}.admin-section h3{color:#0f172a;margin-bottom:1rem}.category-list,.trabajo-admin-list{list-style:none;margin-top:1rem}.category-item,.trabajo-admin-item{display:flex;justify-content:space-between;align-items:center;background:white;padding:0.8rem;margin-bottom:0.5rem;border-radius:5px}.footer{background:#0f172a;color:white;text-align:center;padding:2rem;margin-top:4rem}.loading{text-align:center;padding:2rem;color:#666}.alert{background:#fee;border:1px solid #fcc;color:#c33;padding:1rem;border-radius:5px;margin-bottom:1rem}
    </style>
</head>
<body>
    <header class="header">
        <nav class="nav-container">
            <div class="logo"><span class="logo-icon" id="logoIcon">üèóÔ∏è</span><span>Construcciones Magdaleno</span></div>
            <ul class="nav-menu">
                <li><a id="n1">Inicio</a></li>
                <li><a id="n2">Con√≥cenos</a></li>
                <li><a id="n3">Trabajos</a></li>
                <li><a id="n4">Cont√°ctanos</a></li>
                <li><button class="admin-btn" id="aBtn">üë§ Admin</button></li>
            </ul>
        </nav>
    </header>
    <section id="inicio" class="hero"><h1>Construcciones Magdaleno</h1><p>Calidad y profesionalismo en cada proyecto</p></section>
    <section id="conocenos" class="container"><h2 class="section-title">Con√≥cenos</h2><div class="about-content" id="aC"><div class="loading">Cargando...</div></div></section>
    <section id="trabajos" class="container"><h2 class="section-title">Nuestros Trabajos</h2><div class="filters" id="flt"></div><div class="trabajos-grid" id="tGrid"><div class="loading">Cargando trabajos...</div></div></section>
    <section id="contacto" class="container"><h2 class="section-title">Cont√°ctanos</h2><div class="contact-info"><h3 id="cT">Cargando...</h3><p id="cTxt"></p><p class="contact-phone">üìû 562-430-6442</p></div></section>
    <a href="https://wa.me/5215624306442" target="_blank" class="whatsapp-float">üí¨</a>
    
    <div id="m1" class="modal">
        <div class="modal-content">
            <div class="modal-header"><h2 class="modal-title">Acceso Administrador</h2><button class="close-btn" id="c1">&times;</button></div>
            <div id="loginAlert"></div>
            <div class="form-group"><label>Email:</label><input type="email" id="email" placeholder="admin@ejemplo.com"></div>
            <div class="form-group"><label>Contrase√±a:</label><input type="password" id="pwd"></div>
            <button class="btn" id="lBtn">Ingresar</button>
        </div>
    </div>

    <div id="m2" class="modal"><div class="modal-content"><div class="modal-header"><h2 class="modal-title">Panel de Administraci√≥n</h2><button class="close-btn" id="c2">&times;</button></div><div class="admin-panel"><div class="admin-section"><h3>Logo</h3><div class="form-group"><input type="text" id="lI" placeholder="üèóÔ∏è o https://..."></div><button class="btn" id="uL">Actualizar Logo</button></div><div class="admin-section"><h3>Secci√≥n "Con√≥cenos"</h3><div class="form-group"><textarea id="aI"></textarea></div><button class="btn" id="uA">Actualizar</button></div><div class="admin-section"><h3>Secci√≥n "Cont√°ctanos"</h3><div class="form-group"><label>T√≠tulo:</label><input type="text" id="cTI"></div><div class="form-group"><label>Texto:</label><textarea id="cTxI"></textarea></div><button class="btn" id="uC">Actualizar</button></div><div class="admin-section"><h3>Categor√≠as</h3><div class="form-group"><input type="text" id="nCI"></div><button class="btn" id="aCA">Agregar</button><ul class="category-list" id="cL"></ul></div><div class="admin-section"><h3>Trabajos</h3><button class="btn" id="aTr">Agregar Trabajo</button><ul class="trabajo-admin-list" id="tAL"></ul></div><button class="btn btn-secondary" id="lgOut">Cerrar Sesi√≥n</button></div></div></div>
    <div id="m3" class="modal"><div class="modal-content"><div class="modal-header"><h2 class="modal-title" id="tFT">Agregar Trabajo</h2><button class="close-btn" id="c3">&times;</button></div><div class="form-group"><label>T√≠tulo:</label><input type="text" id="tT"></div><div class="form-group"><label>Descripci√≥n:</label><textarea id="tD"></textarea></div><div class="form-group"><label>Categor√≠a:</label><select id="tCa"></select></div><div class="form-group"><label>Fecha:</label><input type="date" id="tDa"></div><div class="form-group"><label>URL imagen:</label><input type="text" id="tI"></div><button class="btn" id="sT">Guardar</button><button class="btn btn-secondary" id="cnT">Cancelar</button></div></div>
    <footer class="footer"><p>&copy; 2026 Construcciones Magdaleno. Todos los derechos reservados.</p></footer>

    <!-- Firebase -->
    <script type="module">
// INSTRUCCIONES: Reemplaza esta configuraci√≥n con la tuya de Firebase
const firebaseConfig = {
  apiKey: "TU-API-KEY-AQUI",
  authDomain: "tu-proyecto.firebaseapp.com",
  projectId: "tu-proyecto-id",
  storageBucket: "tu-proyecto.appspot.com",
  messagingSenderId: "123456789",
  appId: "tu-app-id"
};

// Importar Firebase desde CDN
import { initializeApp } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js';
import { getFirestore, doc, getDoc, setDoc, onSnapshot } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js';
import { getAuth, signInWithEmailAndPassword, signOut } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js';

const app = initializeApp(firebaseConfig);
const db = getFirestore(app);
const auth = getAuth(app);

const S={a:false,l:'üèóÔ∏è',ab:'En Construcciones Magdaleno nos especializamos en brindar servicios de construcci√≥n de alta calidad. Con a√±os de experiencia en el sector, nuestro equipo de profesionales est√° comprometido con la excelencia en cada proyecto que emprendemos.\n\nNos enorgullece ofrecer soluciones integrales que van desde remodelaciones hasta obras nuevas, siempre con un enfoque en la satisfacci√≥n del cliente y el cumplimiento de los m√°s altos est√°ndares de calidad.',ct:'¬øListo para comenzar tu proyecto?',ctx:'Cont√°ctanos y solicita una cotizaci√≥n sin compromiso. Estamos aqu√≠ para convertir tus ideas en realidad.',ca:['Remodelaci√≥n','Obra Nueva','Pintura','Plomer√≠a','Electricidad','Alba√±iler√≠a'],tr:[{id:1,title:'Remodelaci√≥n Completa de Cocina',description:'Transformamos una cocina antigua en un espacio moderno y funcional con acabados de primera calidad.',category:'Remodelaci√≥n',date:'2024-11-15',image:'https://images.unsplash.com/photo-1556912173-3bb406ef7e77?w=800'},{id:2,title:'Construcci√≥n de Casa Residencial',description:'Obra nueva de 180m¬≤ con dise√±o contempor√°neo, 3 rec√°maras y acabados premium.',category:'Obra Nueva',date:'2024-10-20',image:'https://images.unsplash.com/photo-1600585154340-be6161a56a0c?w=800'},{id:3,title:'Pintura Exterior e Interior',description:'Servicio completo de pintura con preparaci√≥n de superficies y acabado profesional.',category:'Pintura',date:'2024-12-05',image:'https://images.unsplash.com/photo-1589939705384-5185137a7f0f?w=800'}],cf:'Todas',e:null};

async function saveData(field,value){
    try{
        await setDoc(doc(db,'site_config','main'),{[field]:value},{merge:true});
        return true;
    }catch(e){
        console.error('Error:',e);
        alert('Error al guardar. Verifica tu conexi√≥n.');
        return false;
    }
}

async function loadData(){
    try{
        const docSnap=await getDoc(doc(db,'site_config','main'));
        if(docSnap.exists()){
            const d=docSnap.data();
            if(d.logo)S.l=d.logo;
            if(d.about)S.ab=d.about;
            if(d.ctitle)S.ct=d.ctitle;
            if(d.ctext)S.ctx=d.ctext;
            if(d.categories)S.ca=d.categories;
            if(d.trabajos)S.tr=d.trabajos;
        }
    }catch(e){
        console.error('Error cargando:',e);
    }
    updateLogo();
    updateAboutDisplay();
    updateContactDisplay();
    rF();
    rTr();
}

// Escuchar cambios en tiempo real
onSnapshot(doc(db,'site_config','main'),(doc)=>{
    if(doc.exists()&&!S.a){
        const d=doc.data();
        if(d.logo)S.l=d.logo;
        if(d.about)S.ab=d.about;
        if(d.ctitle)S.ct=d.ctitle;
        if(d.ctext)S.ctx=d.ctext;
        if(d.categories)S.ca=d.categories;
        if(d.trabajos)S.tr=d.trabajos;
        updateLogo();
        updateAboutDisplay();
        updateContactDisplay();
        rF();
        rTr();
    }
});

function updateLogo(){
    const ic=document.getElementById('logoIcon');
    if(S.l.startsWith('http'))ic.innerHTML=`<img src="${S.l}">`;
    else ic.textContent=S.l;
}

function updateAboutDisplay(){
    document.getElementById('aC').innerHTML=S.ab.split('\n').filter(p=>p).map(p=>`<p>${p}</p>`).join('');
}

function updateContactDisplay(){
    document.getElementById('cT').textContent=S.ct;
    document.getElementById('cTxt').textContent=S.ctx;
}

function scr(i){document.getElementById(i).scrollIntoView({behavior:'smooth'})}
function oM(i){document.getElementById(i).classList.add('active')}
function cM(i){document.getElementById(i).classList.remove('active')}

function rF(){
    const h=['Todas',...S.ca].map(c=>`<button class="filter-btn ${S.cf===c?'active':''}" onclick="window.fT('${c}')">${c}</button>`).join('');
    document.getElementById('flt').innerHTML=h;
}

window.fT=function(c){S.cf=c;rF();rTr();}

function rTr(){
    let f=S.cf==='Todas'?[...S.tr]:S.tr.filter(t=>t.category===S.cf);
    f.sort((a,b)=>new Date(b.date)-new Date(a.date));
    const h=f.map(t=>`<div class="trabajo-card ${S.a?'admin-mode':''}" onclick="${S.a?`window.oTF(${t.id})`:''}"><img src="${t.image}" class="trabajo-img"><div class="trabajo-content"><div class="trabajo-header"><h3 class="trabajo-title">${t.title}</h3><span class="trabajo-category">${t.category}</span></div><p class="trabajo-date">üìÖ ${new Date(t.date).toLocaleDateString('es-MX',{year:'numeric',month:'long',day:'numeric'})}</p><p class="trabajo-description">${t.description}</p></div></div>`).join('');
    document.getElementById('tGrid').innerHTML=h||'<div class="loading">No hay trabajos en esta categor√≠a</div>';
}

function rCL(){
    const h=S.ca.map(c=>`<li class="category-item"><span>${c}</span><button class="btn btn-danger" style="padding:0.3rem 0.8rem" onclick="window.dC('${c}')">Eliminar</button></li>`).join('');
    document.getElementById('cL').innerHTML=h;
}

function rTAL(){
    const h=S.tr.map(t=>`<li class="trabajo-admin-item"><span>${t.title}</span><div><button class="btn" style="padding:0.3rem 0.8rem;margin-right:0.5rem" onclick="window.oTF(${t.id})">Editar</button><button class="btn btn-danger" style="padding:0.3rem 0.8rem" onclick="window.dT(${t.id})">Eliminar</button></div></li>`).join('');
    document.getElementById('tAL').innerHTML=h;
}

function oAP(){
    document.getElementById('lI').value=S.l;
    document.getElementById('aI').value=S.ab;
    document.getElementById('cTI').value=S.ct;
    document.getElementById('cTxI').value=S.ctx;
    rCL();
    rTAL();
    oM('m2');
}

window.oTF=function(i=null){
    S.e=i;
    const sel=document.getElementById('tCa');
    sel.innerHTML=S.ca.map(c=>`<option value="${c}">${c}</option>`).join('');
    if(i){
        const t=S.tr.find(x=>x.id===i);
        document.getElementById('tFT').textContent='Editar Trabajo';
        document.getElementById('tT').value=t.title;
        document.getElementById('tD').value=t.description;
        document.getElementById('tCa').value=t.category;
        document.getElementById('tDa').value=t.date;
        document.getElementById('tI').value=t.image;
    }else{
        document.getElementById('tFT').textContent='Agregar Trabajo';
        document.getElementById('tT').value='';
        document.getElementById('tD').value='';
        document.getElementById('tDa').value='';
        document.getElementById('tI').value='';
    }
    cM('m2');
    oM('m3');
}

window.dC=async function(c){
    if(confirm(`¬øEliminar "${c}"?`)){
        S.ca=S.ca.filter(x=>x!==c);
        await saveData('categories',S.ca);
        rCL();
        rF();
    }
}

window.dT=async function(i){
    if(confirm('¬øEliminar trabajo?')){
        S.tr=S.tr.filter(t=>t.id!==i);
        await saveData('trabajos',S.tr);
        rTr();
        rTAL();
    }
}

document.getElementById('n1').onclick=()=>scr('inicio');
document.getElementById('n2').onclick=()=>scr('conocenos');
document.getElementById('n3').onclick=()=>scr('trabajos');
document.getElementById('n4').onclick=()=>scr('contacto');
document.getElementById('aBtn').onclick=()=>oM('m1');
document.getElementById('c1').onclick=()=>cM('m1');
document.getElementById('c2').onclick=()=>cM('m2');
document.getElementById('c3').onclick=()=>cM('m3');

document.getElementById('lBtn').onclick=async()=>{
    const email=document.getElementById('email').value;
    const pwd=document.getElementById('pwd').value;
    const alert=document.getElementById('loginAlert');
    
    try{
        await signInWithEmailAndPassword(auth,email,pwd);
        S.a=true;
        cM('m1');
        oAP();
        rTr();
        document.getElementById('email').value='';
        document.getElementById('pwd').value='';
        alert.innerHTML='';
    }catch(e){
        alert.innerHTML='<div class="alert">Email o contrase√±a incorrectos</div>';
    }
};

document.getElementById('lgOut').onclick=async()=>{
    await signOut(auth);
    S.a=false;
    cM('m2');
    rTr();
};

document.getElementById('uL').onclick=async()=>{
    const v=document.getElementById('lI').value.trim();
    if(v){
        S.l=v;
        await saveData('logo',v);
        updateLogo();
        alert('Logo actualizado');
    }
};

document.getElementById('uA').onclick=async()=>{
    const t=document.getElementById('aI').value.trim();
    if(t){
        S.ab=t;
        await saveData('about',t);
        updateAboutDisplay();
        alert('Secci√≥n actualizada');
    }
};

document.getElementById('uC').onclick=async()=>{
    const ti=document.getElementById('cTI').value.trim();
    const tx=document.getElementById('cTxI').value.trim();
    if(ti&&tx){
        S.ct=ti;
        S.ctx=tx;
        await saveData('ctitle',ti);
        await saveData('ctext',tx);
        updateContactDisplay();
        alert('Secci√≥n actualizada');
    }
};

document.getElementById('aCA').onclick=async()=>{
    const c=document.getElementById('nCI').value.trim();
    if(c&&!S.ca.includes(c)){
        S.ca.push(c);
        await saveData('categories',S.ca);
        document.getElementById('nCI').value='';
        rCL();
        rF();
        alert('Categor√≠a agregada');
    }
};

document.getElementById('aTr').onclick=()=>oTF();

document.getElementById('sT').onclick=async()=>{
    const ti=document.getElementById('tT').value.trim();
    const de=document.getElementById('tD').value.trim();
    const ca=document.getElementById('tCa').value;
    const da=document.getElementById('tDa').value;
    const im=document.getElementById('tI').value.trim();
    if(!ti||!de||!da||!im){alert('Completa todos los campos');return;}
    if(S.e){
        const idx=S.tr.findIndex(t=>t.id===S.e);
        S.tr[idx]={...S.tr[idx],title:ti,description:de,category:ca,date:da,image:im};
    }else{
        const nId=Math.max(...S.tr.map(t=>t.id),0)+1;
        S.tr.push({id:nId,title:ti,description:de,category:ca,date:da,image:im});
    }
    await saveData('trabajos',S.tr);
    cM('m3');
    rTr();
    rTAL();
    alert('Trabajo guardado');
};

document.getElementById('cnT').onclick=()=>cM('m3');

loadData();
    </script>
</body>
</html>
